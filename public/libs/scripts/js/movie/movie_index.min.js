"use strict";$.support.cors=!0,$(function(){function t(t,e,i){$.ajax({url:t,cache:!0,type:e,crossDomain:!0}).done(i)}(function(){var e=$(".col-md-6").width();(function(){function i(t){var i=(d-1)*e;$("#screenBody").is(":animated")||("right"===t?l===d?(l=1,$("#scrollMoives .side-index").html(l),$("#screenBody").animate({left:0},500)):(l++,$("#scrollMoives .side-index").html(l),$("#screenBody").animate({left:"-="+e},500)):1===l?(l=d,$("#scrollMoives .side-index").html(l),$("#screenBody").animate({left:"-="+i},500)):(l--,$("#scrollMoives .side-index").html(l),$("#screenBody").animate({left:"+="+e},500)))}var n=($("#scrollMoives .panel"),$("#headerNow span")),l=1,s=$("#scrollMoives .slide-prev"),a=$("#scrollMoives .slide-next"),o=$("#scrollMoives .thumbnail"),r=o.length,c=$(window).width();if(768>c)var d=Math.ceil(r/3),h=o.outerWidth(!0)-o.outerWidth(),m=(e-3*h)/3;else var d=Math.ceil(r/4),h=o.outerWidth(!0)-o.outerWidth(),m=(e-4*h)/4;$("#scrollMoives .side-max").html(d),$("#screenBody").width(e*d),o.width(m),n.on("click",function(){var i=$(this).text(),s="/?galleryName="+encodeURIComponent(i);t(s,"GET",function(t){var s=t.data||[],a=s.movies,f=s.movies.length;if($("#headerNow a").attr("href","/movie/results?cat="+s._id+"&p=0").text(s.name),"即将上映"===i?n.text("正在上映"):n.text("即将上映"),f<o.length)$("#scrollMoives .thumbnail:gt("+(f-1)+")").remove();else if(f>o.length){for(var u=o.length;f>u;u++)$("#screenBody").append('<div class="thumbnail scroll-item"><a href="" target="_blank"><img src="" alt="" /></a><div class="caption"><h5></h5><p><a class="btn btn-primary" href="" role="button">观看预告片</a></p></div></div>');$("#screenBody .thumbnail:gt("+(o.length-1)+")").width(m)}o=$("#scrollMoives .thumbnail"),r=o.length,c=$(window).width(),768>c?(d=Math.ceil(r/3),h=o.outerWidth(!0)-o.outerWidth(),m=(e-3*h)/3):(d=Math.ceil(r/4),h=o.outerWidth(!0)-o.outerWidth(),m=(e-4*h)/4),$("#scrollMoives .side-max").html(d),$("#screenBody").width(e*d);for(var v=0;v<o.length;v++)if(a[v]){$(o[v]).find("a").attr("href","/movie/"+a[v]._id),$(o[v]).find("h5").html(a[v].title);var p=$(o[v]).find("img");a[v].poster&&(a[v].poster.indexOf("http:")>-1?p.attr("src",a[v].poster).attr("alt",a[v].poster):p.attr("src","/upload/movie/"+a[v].poster).attr("alt",a[v].poster))}l>d&&(l=d,$("#scrollMoives .side-index").html(l),$("#screenBody").animate({left:-e*(l-1)},0))})}),a.on("click",function(){i("right")}),s.on("click",function(){i("left")});var f=setInterval(function(){i("right")},5e3);$("#scrollMoives").on("mouseover",function(){clearInterval(f)}).on("mouseout",function(){f=setInterval(function(){i("right")},5e3)})})();$("#fliterMovies .class-top").on("click","button",function(){if(!$(this).is(".btn-primary")){var e=$(this).html(),i="/?fliterName="+encodeURIComponent(e+"电影");t(i,"GET",function(t){if(null===t.data||0===t.data.movies.length)$("#classBody").html("");else{var e=t.data.movies,i=$("#classBody .thumbnail"),n=e.length-1;if(e.length<i.length)$("#fliterMovies .col-md-3:gt("+n+")").remove();else if(e.length>i.length)for(var l=i.length;l<e.length;l++)$("#classBody").append('<div class="col-md-3 col-sm-3 col-xs-4"><div class="thumbnail"><a href=""><img src="" alt="" /></a><div class="caption"><h5></h5></div></div></div>');i=$("#classBody .thumbnail");for(var s=0;s<i.length;s++)if(e[s]){$(i[s]).find("a").attr("href","/movie/"+e[s]._id),$(i[s]).find("h5").html(e[s].title);var a=$(i[s]).find("img");e[s].poster&&(e[s].poster.indexOf("http:")>-1?a.attr("src",e[s].poster).attr("alt",e[s].poster):a.attr("src","/upload/movie/"+e[s].poster).attr("alt",e[s].poster))}}}),$(this).addClass("btn-primary").removeClass("btn-default").parent().siblings().children().addClass("btn-default").removeClass("btn-primary")}});(function(){function t(t){a.is(":animated")||("right"===t?(i++,$("#galleryFrames .side-index").html(i),a.animate({left:"-="+e},500),i===s-1&&(i=1,$("#galleryFrames .side-index").html(i),a.animate({left:-e+"px"},0))):(i--,$("#galleryFrames .side-index").html(i),a.animate({left:"+="+e},500),0===i&&(i=s-2,$("#galleryFrames .side-index").html(i),a.animate({left:-(e*(s-2))+"px"},0))))}var i=1,n=$("#galleryFrames .slide-prev"),l=$("#galleryFrames .slide-next"),s=$("#galleryFrames li").length,a=$("#galleryFrames ul"),o=$("#galleryFrames .slide-item");$("#galleryFrames .side-max").html(s-2),a.width(e*s),a.css("left",-e),o.width(e),l.on("click",function(){t("right")}),n.on("click",function(){t("left")});var r=setInterval(function(){t("right")},5e3);$("#galleryFrames").on("mouseover",function(){clearTimeout(r)}).on("mouseout",function(){r=setInterval(function(){t("right")},5e3)})})(),function(){function e(){var e=i.children("span").text(),n=o.val(),l="/?cityName="+encodeURIComponent(e)+"&&search="+encodeURIComponent(n);t(l,"GET",function(t){var e=t||[];a.html("");for(var i=0;i<e.length;i++)a.append('<li><a href="javascript:;">'+e[i]+"</a></li>");s.css("display","block")})}var i=$("#citySearch"),n=$("#citiesList"),l=$("#citySug"),s=$("#citySug .city-suggestion-list"),a=$("#citySug .auto-tip"),o=$("#citySug input");n.outerWidth(i.width()+l.width()),i.children("span").on("click",function(){"none"===n.css("display")?n.css("display","block"):n.css("display","none")}),$(".cities-list-hd").on("click","li",function(){var t=$(this).attr("index");$(this).addClass("on").siblings().removeClass("on"),n.find(".cities-list-item").eq(t-1).addClass("active").siblings().removeClass("active")}),$("#citiesList .cities-list-item").on("click","a",function(){i.children("span").html($(this).html()),n.css("display","none"),o.val("")}),o.on("focus",function(){e(),n.css("display","none")}),o.keyup(function(t){e()}),s.on("mousedown","a",function(){o.val($(this).html()),s.css("display","none")}),o.on("blur",function(){s.css("display","none")})}()})()});